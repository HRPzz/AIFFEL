# 17. 난 스케치를 할 테니 너는 채색을 하거라

**이미지 생성 모델로 사용되는 GAN 중에서 조건이 추가된 cGAN에 대해 알아보고 Pix2Pix를 배워봅니다.**

---

|-|목차|⏲ 420분|
|:---:|---|:---:|
|17-1| 들어가며 | 5분|
|17-2| 조건 없는 생성모델(Unconditional Generative Model), GAN 🔒| 5분|
|17-3| 조건 있는 생성모델(Conditional Generative Model), cGAN 🔒| 15분|
|17-4| 내가 원하는 숫자 이미지 만들기 (1) Generator 구성하기 🔒| 20분|
|17-5| 내가 원하는 숫자 이미지 만들기 (2) Discriminator 구성하기 🔒| 20분|
|17-6| 내가 원하는 숫자 이미지 만들기 (3) 학습 및 테스트하기 🔒| 25분|
|17-7| GAN의 입력에 이미지를 넣는다면? Pix2Pix 🔒| 20분|
|17-8| 난 스케치를 할 테니 너는 채색을 하거라 (1) 데이터 준비하기 🔒| 20분|
|17-9| 난 스케치를 할 테니 너는 채색을 하거라 (2) Generator 구성하기 🔒| 30분|
|17-10| 난 스케치를 할 테니 너는 채색을 하거라 (3) Generator 재구성하기 🔒| 25분|
|17-11| 난 스케치를 할 테니 너는 채색을 하거라 (4) Discriminator 구성하기 🔒| 25분|
|17-12| 난 스케치를 할 테니 너는 채색을 하거라 (5) 학습 및 테스트하기 🔒| 30분|
|17-13| 프로젝트 : Segmentation map으로 도로 이미지 만들기 🔒| 180분|
|17-14| 프로젝트 제출 🔒|

---

### 학습 목표

- 조건을 부여하여 생성 모델을 다루는 방법에 대해 이해합니다.
- cGAN 및 Pix2Pix의 구조와 학습 방법을 이해하고 잘 활용합니다.
- CNN 기반의 모델을 구현하는데 자신감을 갖습니다.

### 학습 전제

- Tensorflow의 Subclassing API로 레이어 및 모델을 구성하는 방법에 대해 대략적으로 알고 있어야 합니다.
- 신경망의 학습 방법에 대한 전반적인 절차를 알고 있어야 합니다.
- CNN, GAN에 대한 기본적인 개념을 알고 있어야 합니다.
- Tensorflow의 GradientTape API를 이용한 학습 코드를 보고 이해할 수 있어야 합니다.
- (중요) Tensorflow 내에서 잘 모르는 함수(또는 메서드)를 발견했을 때, 공식 문서에서 검색하고 이해해 보려는 의지가 필요합니다.

### 목차

1. 조건 없는 생성 모델(Unconditional Generative Model), GAN
2. 조건 있는 생성 모델(Conditional Generative Model), cGAN
3. 내가 원하는 숫자 이미지 만들기 (1) Generator 구성하기
4. 내가 원하는 숫자 이미지 만들기 (2) Discriminator 구성하기
5. 내가 원하는 숫자 이미지 만들기 (3) 학습 및 테스트하기
6. GAN의 입력에 이미지를 넣는다면? Pix2Pix
7. 난 스케치를 할 테니 너는 채색을 하거라 (1) 데이터 준비하기
8. 난 스케치를 할 테니 너는 채색을 하거라 (2) Generator 구성하기
9. 난 스케치를 할 테니 너는 채색을 하거라 (3) Generator 재구성하기
10. 난 스케치를 할 테니 너는 채색을 하거라 (4) Discriminator 구성하기
11. 난 스케치를 할 테니 너는 채색을 하거라 (5) 학습 및 테스트하기
12. 프로젝트 : Segmentation map으로 도로 이미지 만들기

---

## 17-13. 프로젝트 : Segmentation map으로 도로 이미지 만들기

### 프로젝트 수행

1. 데이터에 한 가지 이상의 **augmentation 방법을 적용** 하여 학습해 주세요. (어떠한 방법을 사용했는지 적어주세요.)
2. 이전에 구현했던 두 개의 Generator 중 Encoder와 Decoder간에 skip connection이 있는 **U-Net Generator를 사용** 해 주세요.
3. 모델 학습 후, 학습된 Generator를 이용해 테스트합니다. 테스트 데이터는 다운로드했던 "val" 폴더 내 이미지를 사용해 주세요.
4. 1개 이상의 이미지에 대해 테스트 과정을 거친 후 그 결과를 **스케치, 생성된 사진, 실제 사진 순서로 나란히 시각화** 해 주세요.
5. 모델을 충분히 학습하기에 시간이 부족할 수 있습니다. 적어도 10 epoch 이상 학습하며 **중간 손실 값에 대한 로그** 를 남겨주세요. 좋은 결과를 얻기 위해선 긴 학습 시간이 필요하므로 테스트 결과는 만족스럽지 않아도 괜찮습니다.

---

>## **루브릭**

>|번호|평가문항|상세기준|평가결과|
>|:---:|---|---|:---:|
>|1|pix2pix 모델 학습을 위해 필요한 데이터셋을 적절히 구축하였다.|데이터 분석 과정 및 한 가지 이상의 augmentation을 포함한 데이터셋 구축 과정이 체계적으로 제시되었다.|-|
>|2|pix2pix 모델을 구현하여 성공적으로 학습 과정을 진행하였다.|U-Net generator, discriminator 모델 구현이 완료되어 train_step이 안정적으로 진행됨을 확인하였다.|-|
>|3|학습 과정 및 테스트에 대한 시각화 결과를 제출하였다.|10 epoch 이상의 학습을 진행한 후 최종 테스트 결과에서 진행한 epoch 수에 걸맞은 정도의 품질을 확인하였다.|-|
